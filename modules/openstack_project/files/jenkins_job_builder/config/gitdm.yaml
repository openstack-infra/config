- job:
    name: gate-gitdm
    node: precise

    wrappers:
      - timeout:
          timeout: 90
          fail: true
      - timestamps

    triggers:
      - zuul

    builders:
      - shell: |
          #!/bin/bash -xe
          export TEMPDIR=${TEMPDIR:-$(mktemp -d $(pwd)/dmtmp-XXXXXX)}
          export GITBASE=${TEMPDIR}/git
          export LP_STATS=n
          bash ./do-it.sh
      - link-logs

    publishers:
      - console-log


- job:
    name: periodic-gitdm
    node: precise

    wrappers:
      - timeout:
          timeout: 90
          fail: true
      - timestamps

    triggers:
      - timed: '0 6 * * *'

    builders:
      - devstack-inprogress
      - devstack-checkout
      - shell: |
          #!/bin/bash -xe
          export TEMPDIR=${TEMPDIR:-$(mktemp -d $(pwd)/dmtmp-XXXXXX)}
          export GITBASE=${TEMPDIR}/git
          export LP_STATS=n
          bash ./do-it.sh
      - link-logs

    publishers:
      - console-log-periodic
