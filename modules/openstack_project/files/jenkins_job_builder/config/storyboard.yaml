- job:
    name: gate-storyboard-webclient-unittests
    node: bare-precise

    builders:
      - gerrit-git-prep
      - shell: |
          ./bin/bootstrap.sh
          ./bin/build.sh
    publishers:
      - console-log
      - coverage-log
      - scp:
          site: 'static.openstack.org'
          files:
            - target: 'logs/$LOG_PATH'
              source: './reports/**'
              keep-hierarchy: true
              copy-after-failure: true

- job:
    name: storyboard-webclient-branch-release
    node: bare-precise

    builders:
      - gerrit-git-prep
      - shell: |
          ./bin/bootstrap.sh
          ./bin/build.sh
      - shell: |
          #!/bin/bash -xe
          BRANCH=$ZUUL_REFNAME
          BRANCH_PATH=`echo $BRANCH | tr / -`
          tar -czf {name}-$BRANCH_PATH.tar.gz dist/
          mv {name}-$BRANCH_PATH.tar.gz dist/
    publishers:
      - console-log
      - coverage-log
      - scp:
          site: 'static.openstack.org'
          files:
            - target: 'logs/$LOG_PATH'
              source: './reports/**'
              keep-hierarchy: true
              copy-after-failure: true
      - tarball:
          project: '{name}'
          site: '{tarball-site}'

- job:
    name: storyboard-webclient-release
    node: bare-precise

    builders:
      - gerrit-git-prep
      - shell: |
          ./bin/bootstrap.sh
          ./bin/build.sh
      - shell: |
          #!/bin/bash -xe
          tar -czf {name}.tar.gz dist/
          mv {name}.tar.gz dist/
    publishers:
      - console-log
      - coverage-log
      - scp:
          site: 'static.openstack.org'
          files:
            - target: 'logs/$LOG_PATH'
              source: './reports/**'
              keep-hierarchy: true
              copy-after-failure: true
      - tarball:
          project: '{name}'
          site: '{tarball-site}'