- job-template:
    name: 'periodic-{name}-python26-{branch-name}'
    concurrent: true

    wrappers:
      - timeout:
          timeout: 30
          fail: true
      - timestamps

    logrotate:
      daysToKeep: 28
      numToKeep: -1
      artifactDaysToKeep: -1
      artifactNumToKeep: -1

    triggers:
      - timed: '@daily'

    builders:
      - python26

    publishers:
      - scp:
          site: 'static.openstack.org'
          files:
            - target: 'logs/$ZUUL_SHORT_NEWREV/$ZUUL_PIPELINE/$JOB_NAME/$BUILD_NUMBER'
              source: '**/results.html'
              keep-hierarchy: false
              copy-after-failure: true
            - target: 'logs/$ZUUL_SHORT_NEWREV/$ZUUL_PIPELINE/$JOB_NAME/$BUILD_NUMBER'
              copy-console: true
              copy-after-failure: true

    scm:
      - git: 
          url: 'git://github.com/{github-org}/{name}.git'
          branches:
            - 'origin/{branch}'

    # >= precise does not have python2.6
    node: oneiric
  

- job-template:
    name: 'periodic-{name}-python27-{branch-name}'
    concurrent: true

    wrappers:
      - timeout:
          timeout: 30
          fail: true
      - timestamps

    logrotate:
      daysToKeep: 28
      numToKeep: -1
      artifactDaysToKeep: -1
      artifactNumToKeep: -1

    triggers:
      - timed: '@daily'

    builders:
      - python27

    publishers:
      - scp:
          site: 'static.openstack.org'
          files:
            - target: 'logs/$ZUUL_SHORT_NEWREV/$ZUUL_PIPELINE/$JOB_NAME/$BUILD_NUMBER'
              source: '**/results.html'
              keep-hierarchy: false
              copy-after-failure: true
            - target: 'logs/$ZUUL_SHORT_NEWREV/$ZUUL_PIPELINE/$JOB_NAME/$BUILD_NUMBER'
              copy-console: true
              copy-after-failure: true

    scm:
      - git: 
          url: 'git://github.com/{github-org}/{name}.git'
          branches:
            - 'origin/{branch}'

    node: '{node}'
  

- job-template:
    name: 'periodic-{name}-docs-{branch-name}'
    concurrent: true

    wrappers:
      - timeout:
          timeout: 30
          fail: true
      - timestamps

    logrotate:
      daysToKeep: 28
      numToKeep: -1
      artifactDaysToKeep: -1
      artifactNumToKeep: -1

    triggers:
      - timed: '@daily'

    builders:
      - docs

    publishers:
      - console-log-periodic

    scm:
      - git: 
          url: 'git://github.com/{github-org}/{name}.git'
          branches:
            - 'origin/{branch}'

    node: '{node}'

  
- job-group:
    name: python-diablo-bitrot-jobs
    branch: 'stable/diablo'
    branch-name: 'stable-diablo'
    node: oneiric
    jobs:
      - 'periodic-{name}-python26-{branch-name}'
      - 'periodic-{name}-python27-{branch-name}'
      - 'periodic-{name}-docs-{branch-name}'


- job-group:
    name: python-essex-bitrot-jobs
    branch: 'stable/essex'
    branch-name: 'stable-essex'
    node: precise
    jobs:
      - 'periodic-{name}-python26-{branch-name}'
      - 'periodic-{name}-python27-{branch-name}'
      - 'periodic-{name}-docs-{branch-name}'
