- job-template:
    name: 'puppet-{repo}-{puppet_version}-unit'
    project-type: freestyle
    defaults: global
    disabled: false
    concurrent: true
    quiet-period: 0
    block-downstream: false
    block-upstream: false
    builders:
      - shell: |
          export PUPPET_GEM_VERSION={puppet_version}
          bundle install
          echo {puppet_version} | grep '2.6' && git clone git://github.com/puppetlabs/puppetlabs-create_resources.git spec/fixtures/modules/create_resources || true
          bundle exec rake spec SPEC_OPTS='--format documentation'
- job-group:
    name: 'puppet-module-unit'
    puppet_version:
      - 2.6
      - 2.7
      - 3.0
      - 3.1
    repo:
      - glance
      - keystone
      - cinder
      - nova
      - horizon
      - openstack
      - swift
    jobs:
      - 'puppet-{repo}-{puppet_version}-unit'
